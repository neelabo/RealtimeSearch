# RealtimeSearch

## ソフトの概要

  ファイル検索を行うツールです。

  * クリップボード監視機能があります。
  * 検索フォルダをインデックス化し、インクリメンタルサーチを行います。
  * あいまい検索により検索しやすくなっています。


## 動作環境

  * Windows 7 SP1, Windows 8.1, Windows 10
  * .NET Framework 4.7.2 以降が必要です。起動しない場合は [Microsoft .NET](https://dotnet.microsoft.com/download/dotnet-framework-runtime) から入手してインストールしてください。

## インストール・アンインストール方法

  インストール不要です。そのまま `RealtimeSearh.exe` を起動してください。  
  アンインストールはファイルを削除するだけです。


## クイックスタート

まず、設定ウィンドウで検索フォルダを追加します。  
メインウィンドウ上部のテキストボックスに検索キーワードを入力すれば検索が始まります。  
検索結果のファイルのコンテキストメニューから各種操作ができます。


## 設定ウィンドウ

### 検索フォルダ

* ここに追加されたフォルダ以下のファイルが検索対象になります。

注意: 起動時にインデックス化しますので、非常に多くのファイルがあるフォルダ(ドライブ等)を追加すると、初回の検索に時間がかかります。ご注意ください。

### クリップボードを監視

* この機能を有効にしておくと、ブラウザやメール等でコピーされたテキストを検索キーワードとして即時に検索を開始します。

### 常に手前に表示

* ウィンドウを常に画面手前に表示します。

### Web検索

* Web検索用のURLを使用します。
* `$(query)` が検索キーワードに置換されます。


### 外部アプリ設定

* 検索結果から起動するアプリを指定します。
* 最大3つまで登録できます。Enterキーファイルを実行する場合、対応する拡張子の外部アプリが選択されます。
* 指定がない場合、既定のアプリを使用します。
* 通常の外部プログラム起動とプロトコル起動(http://のようにURIで起動できるもの)に対応
* `$(file)` がファイルパスに置換されます
* `$(uri)` がURIエスケープされたファイルパスに置換されます


### 設定ファイルについて

設定は実行ファイルと同じフォルダに `UserSetting.xml` として保存されます。  
インストーラー版では `%APPDATA%\Local\NeeLaboratory\RealtimeSearch` フォルダーに保存されます。   
このファイルを削除してから起動すると設定が初期化されます。


## 検索キーワード

空白文字区切りで、すべての単語にヒットしたファイル名をリストアップします(AND検索)。  
標準では、なるべく検索しやすいように以下の様なあいまい検索をしています。

* 半角、全角を区別しません。
* ひらがな、カタカナを区別しません。
* 英数の大文字、小文字を区別しません。
* 数字は"0"から始まる場合の区別をしません。(例："2015年2月4日" と "2015年02月04日" は区別されない)
* UNICODE正規化(NFKC)を使用しています。(例："㌫" と "パーセント" は区別されない)

### 検索オプション

検索オプションは直後の検索単語にのみ影響します。

接続オプション|説明
-|-
/and|AND検索 (デフォルト)
/or|OR検索
/not|NOT検索

検索オプション|説明|補足
-|-|-
/m0, /exact|完全一致| "ダブルクオートで囲むのと同じです"。標準のあいまい検索でなく完全一致の検索を行います。
/m1, /word|単語一致| 文字の種類で単語を識別しているので精度はあまりよくありません。この検索ではひらがなとカタカナを区別します。
/m2|標準 (デフォルト)|
/re|正規表現| [.NETの正規表現](https://docs.microsoft.com/ja-jp/dotnet/standard/base-types/regular-expression-language-quick-reference)
/ire|正規表現・大文字小文字無効|大文字と小文字を区別しない正規表現検索を行う
/since|日時指定・以後|指定日時以後
/until|日時指定・以前|指定日時以前

### 日時指定フォーマット

通常は "2019-04-01" といった形式で指定します。 [.NETの日時変換](https://docs.microsoft.com/ja-jp/dotnet/standard/base-types/parsing-datetime)を使用しているため、それ以外の形式でも指定可能です。  
注意点として、"2019-04-01" という日にちの指定は "2019-04-01 00:00:00" と解釈されるため、"/until 2019-04-01" では4月1日は含まれません。

また、"-12day", "-6month" "-1year" といった形式で相対日時を指定可能です。  
"/since -5day" は「過去5日以内」という意味になります。 

### 使用例

"ABC","DEF"のAND標準検索 

    ABC DEF

"^ABC$"の正規表現検索 

    /re ^ABC$

"ABC DEF"の完全一致検索 

    "ABC DEF"

"ABC"標準検索結果に対する、"DEF"NOT単語検索 

    ABC /not /word DEF

2019年4月に更新されたファイルの検索

    /since 2019-04-01 /until 2019-05-01

## 連絡先

  * [ヨクアルナニカ](http://yokuarunanika.blogspot.jp/)
  * [RealtimeSearch プロジェクトページ](https://bitbucket.org/neelabo/realtimesearch/)